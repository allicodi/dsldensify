% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runner_direct_gaussian_homosced.R
\name{make_gaussian_homosced_direct_runner}
\alias{make_gaussian_homosced_direct_runner}
\title{Create a Gaussian (normal) conditional density runner with homoscedastic errors}
\usage{
make_gaussian_homosced_direct_runner(
  rhs_list,
  use_weights_col = TRUE,
  strip_fit = TRUE
)
}
\arguments{
\item{rhs_list}{A list of RHS specifications, either:
\itemize{
  \item one-sided formulas such as \code{~ W1 + W2}, or
  \item character strings such as \code{"W1 + W2"}.
}
Each RHS is used to form \code{A ~ <rhs>} for fitting the mean model.}

\item{use_weights_col}{Logical. If \code{TRUE} and \code{train_set} contains a
column named \code{wts}, fitting uses weighted least squares and \eqn{\sigma}
is estimated using the same weights.}

\item{strip_fit}{Logical. If \code{TRUE}, attempt to reduce stored fit size by
removing large components from the \code{lm} object (keeps prediction working).}
}
\value{
A runner (named list) with elements:
\describe{
  \item{method}{Character string \code{"gaussian_homosked"}.}
  \item{tune_grid}{Data frame with columns \code{.tune} and \code{rhs}.}
  \item{fit}{Function \code{fit(train_set, ...)} returning \code{list(fits=...)}.}
  \item{log_density}{Function returning an \code{n x K} matrix of log densities.}
  \item{density}{Function returning an \code{n x K} matrix of densities.}
  \item{sample}{Function drawing samples \code{A*} given \code{W} (assumes \code{K=1}).}
  \item{fit_one}{Fit only the selected tune (returns minimal bundle).}
}
}
\description{
Constructs a **direct density** runner that models
\eqn{A \mid W \sim \mathcal{N}(\mu(W), \sigma^2)} with **constant** \eqn{\sigma}
across observations. The conditional mean \eqn{\mu(W)} is fit via
weighted least squares using \code{stats::lm()} with one model per RHS in
\code{rhs_list}. The runner exposes \code{log_density()} (and optionally
\code{density()}) for use in \code{run_direct_setting()} and global selection.

The runner also provides \code{sample()} to draw
\eqn{A^* \sim \hat f(\cdot \mid W)} from the fitted conditional normal model.
Sampling is intended to be called on a **selected** fit (i.e.,
\code{length(fit_bundle$fits) == 1}).
}
\section{Numeric-only requirement}{

For stable behavior across CV folds and to avoid factor-level bookkeeping,
this runner is intended for **numeric predictors only**. RHS formulas should
not include factors/characters. No coercion is performed.
}

