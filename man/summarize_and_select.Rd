% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{summarize_and_select}
\alias{summarize_and_select}
\title{Summarize and select the best conditional density estimator by cross-validated risk}
\usage{
summarize_and_select(
  select_out,
  hazard_learners = NULL,
  direct_learners = NULL,
  weighted = TRUE
)
}
\arguments{
\item{select_out}{List of selection outputs. Each element corresponds to one
grid setting and must contain \code{$grid_type}, \code{$n_bins}, and
\code{$cv_out}. Each fold object in \code{$cv_out} must contain:
\describe{
  \item{\code{fold}}{Fold index.}
  \item{\code{fold_weight}}{Fold weight used for weighted aggregation.}
  \item{\code{wts_valid}}{Optional observation weights for the validation set
    (used when \code{L$loss} is a matrix).}
  \item{\code{learners}}{List of per-learner fold outputs. Each must include
    \code{$learner} and \code{$loss}.}
}}

\item{hazard_learners}{Optional named list of hazard-based runner objects.
Names are used to determine which learners are hazard-based.}

\item{direct_learners}{Optional named list of direct density runner objects.
Names are used to determine which learners are direct.}

\item{weighted}{Logical. If \code{TRUE}, aggregate fold losses using
\code{fold_weight} from fold objects. If \code{FALSE}, aggregate by simple
averaging across folds.}
}
\value{
A named list with elements:
\describe{
  \item{\code{summary_all}}{A \code{data.table} with one row per
    \code{(grid_type, n_bins, learner, .tune)} combination and columns
    \code{cv_risk} and \code{V} (number of fold entries contributing). Sorted
    by \code{cv_risk}.}
  \item{\code{summary_by_learner}}{A named list of \code{data.table} objects,
    one per learner, formed by merging \code{cv_risk} with the learner's
    \code{tune_grid} (when available). For direct learners, \code{n_bins} is
    dropped and \code{grid_type} is set to \code{"direct"}.}
  \item{\code{best}}{A single-row \code{data.table} giving the minimizing
    learner, tuning index, and (when relevant) grid setting.}
}
}
\description{
Aggregates fold-level losses from a collection of selection outputs
(hazard-grid settings and/or a direct setting) and selects the overall best
learner and tuning index by minimizing cross-validated risk.

This function is used in non-hurdle mode to compare hazard-based density
learners (which depend on a binning grid specification) and direct density
learners (which do not depend on binning).
}
\details{
Fold-level losses may be provided either as a numeric vector of length \eqn{K}
(one value per tuning choice), or as a matrix with one column per tuning choice.
When \code{loss} is a matrix, the function computes a fold-level summary loss
for each tuning choice by taking column means. If \code{wts_valid} is present
in the fold object, weighted column means are used:
\deqn{
  \bar\ell_k = \frac{\sum_i w_i \ell_{ik}}{\sum_i w_i}.
}
Fold-level losses are then aggregated across folds to produce cross-validated
risk, optionally weighted by \code{fold_weight}.
}
\seealso{
\code{\link{summarize_and_select}} \code{\link{dsldensify}}
}
