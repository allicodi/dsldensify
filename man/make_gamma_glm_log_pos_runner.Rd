% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/runner_pos_gamma_log.R
\name{make_gamma_glm_log_pos_runner}
\alias{make_gamma_glm_log_pos_runner}
\title{Create a Gamma GLM conditional density runner with log link}
\usage{
make_gamma_glm_log_pos_runner(
  rhs_list,
  use_weights_col = TRUE,
  strip_fit = TRUE,
  maxit = 50L,
  epsilon = 1e-08
)
}
\arguments{
\item{rhs_list}{A list of RHS specifications, either:
\itemize{
  \item one-sided formulas such as \code{~ W1 + W2}, or
  \item character strings such as \code{"W1 + W2"}.
}
Each RHS is used to form \code{A ~ <rhs>} for fitting the mean model.}

\item{use_weights_col}{Logical. If \code{TRUE} and \code{train_set} contains a
column named \code{wts}, fitting uses \code{weights = wts}.}

\item{strip_fit}{Logical. If \code{TRUE}, attempt to reduce stored fit size by
removing large components from the \code{glm} object (keeps prediction working).}

\item{maxit}{Integer. Maximum number of IRWLS iterations passed via
\code{glm.control(maxit = ...)}.}

\item{epsilon}{Numeric. Convergence tolerance passed via
\code{glm.control(epsilon = ...)}.}
}
\value{
A runner (named list).
}
\description{
Constructs a **direct density** runner for strictly positive outcomes,
modeling
\eqn{A \mid W \sim \mathrm{Gamma}(\mu(W), \phi)} with a log link:
\deqn{\log \mu(W) = X\beta.}
The mean model is fit via \code{stats::glm()} with
\code{family = stats::Gamma(link = "log")}, one model per RHS in
\code{rhs_list}.

Density evaluation uses the Gamma GLM variance convention
\eqn{\mathrm{Var}(A \mid W) = \phi \mu(W)^2}. Under this convention, a Gamma
distribution with
\eqn{\text{shape} = 1/\phi} and \eqn{\text{scale} = \mu \phi}
has mean \eqn{\mu} and variance \eqn{\phi \mu^2}. Thus \code{log_density()}
computes
\code{dgamma(A, shape = 1/phi, scale = mu * phi, log = TRUE)}.

The runner also provides \code{sample()} to draw
\eqn{A^* \sim \hat f(\cdot \mid W)} from the fitted conditional Gamma model.
Sampling is intended to be called on a **selected** fit (i.e.,
\code{length(fit_bundle$fits) == 1}).
}
\section{Strict positivity requirement}{

This runner requires \eqn{A > 0}. If any \eqn{A \le 0} appears in training data
(or in \code{newdata} passed to \code{log_density()}), the runner errors.
}

\section{Numeric-only requirement}{

For stable behavior across CV folds and to avoid factor-level bookkeeping,
this runner is intended for **numeric predictors only**. RHS formulas should
not include factors/characters. No coercion is performed.
}

